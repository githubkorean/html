<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>âš¾ ìˆ«ì ìë¦¬ ë§ì¶”ê¸° ê²Œì„</title>
    <style>
        body {
            font-family: 'Arial', sans-serif;
            max-width: 500px;
            margin: 0 auto;
            padding: 20px;
            text-align: center;
            background-color: #f5f5f5;
            color: #333;
            position: relative;
        }
        .game-container {
            background-color: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            position: relative;
            z-index: 1;
            filter: none;
            transition: filter 0.3s;
        }
        h1 {
            color: #2c3e50;
            margin-bottom: 10px;
        }
        .score {
            font-size: 1.2em;
            margin-bottom: 20px;
            color: #3498db;
            font-weight: bold;
        }
        .number-buttons {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 10px;
            margin: 20px 0;
        }
        .number-btn {
            padding: 15px 0;
            font-size: 18px;
            background-color: #3498db;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s;
        }
        .number-btn:hover:not(:disabled) {
            background-color: #2980b9;
            transform: translateY(-2px);
        }
        .number-btn:disabled {
            background-color: #95a5a6;
            cursor: not-allowed;
        }
        .action-buttons {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin: 20px 0;
        }
        .action-btn {
            padding: 10px 20px;
            font-size: 16px;
            background-color: #2ecc71;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s;
        }
        .action-btn:hover {
            background-color: #27ae60;
            transform: translateY(-2px);
        }
        .action-btn:active {
            transform: translateY(0);
        }
        .action-btn.reset {
            background-color: #e74c3c;
        }
        .action-btn.reset:hover {
            background-color: #c0392b;
        }
        .current-guess {
            font-size: 1.5em;
            letter-spacing: 5px;
            margin: 20px 0;
            min-height: 30px;
        }
        .result-history {
            margin-top: 20px;
            padding: 15px;
            background-color: #f8f9fa;
            border-radius: 5px;
            text-align: left;
            max-height: 300px;
            overflow-y: auto;
        }
        .result-item {
            margin-bottom: 10px;
            padding: 10px;
            border-bottom: 1px solid #eee;
        }
        .strike {
            color: #e74c3c;
            font-weight: bold;
        }
        .ball {
            color: #3498db;
            font-weight: bold;
        }
        .out {
            color: #7f8c8d;
            font-weight: bold;
        }
        .win-message {
            font-size: 1.5em;
            font-weight: bold;
            margin: 20px 0;
            padding: 15px;
            border-radius: 5px;
            background-color: #d4edda;
            color: #155724;
            animation: pulse 1.5s infinite;
        }
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        .music-control {
            position: absolute;
            top: 20px;
            right: 20px;
            background-color: rgba(255,255,255,0.8);
            padding: 8px 12px;
            border-radius: 20px;
            display: flex;
            align-items: center;
            gap: 8px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            z-index: 10;
        }
        .music-toggle {
            width: 40px;
            height: 20px;
            background-color: #ccc;
            border-radius: 10px;
            position: relative;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        .music-toggle.active {
            background-color: #3498db;
        }
        .toggle-switch {
            width: 16px;
            height: 16px;
            background-color: white;
            border-radius: 50%;
            position: absolute;
            top: 2px;
            left: 2px;
            transition: transform 0.3s;
        }
        .music-toggle.active .toggle-switch {
            transform: translateX(20px);
        }
        .music-icon {
            font-size: 18px;
        }
        #startOverlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(255,255,255,0.9);
            backdrop-filter: blur(8px);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            cursor: pointer;
            font-size: 2rem;
            font-weight: bold;
            color: #3498db;
            user-select: none;
            flex-direction: column;
        }
        #startOverlay p {
            font-size: 1rem;
            margin-top: 10px;
            color: #7f8c8d;
        }
    </style>
</head>
<body>
    <!-- ì‹œì‘ ì˜¤ë²„ë ˆì´ -->
    <div id="startOverlay">
        ê²Œì„ ì‹œì‘
        <p>í™”ë©´ì„ í´ë¦­í•˜ë©´ ê²Œì„ì´ ì‹œì‘ë©ë‹ˆë‹¤</p>
    </div>

    <!-- ìŒì•… ì»¨íŠ¸ë¡¤ -->
    <div class="music-control">
        <span class="music-icon">ğŸµ</span>
        <div class="music-toggle active" id="musicToggle">
            <div class="toggle-switch"></div>
        </div>
    </div>

    <div class="game-container">
        <h1>âš¾ ìˆ«ì ìë¦¬ ë§ì¶”ê¸° ê²Œì„</h1>
        <div class="score">ì ìˆ˜: <span id="score">0</span></div>
        
        <div class="current-guess" id="currentGuess"></div>
        
        <div class="number-buttons" id="numberButtons">
            <!-- ìˆ«ì ë²„íŠ¼ë“¤ì€ JavaScriptì—ì„œ ë™ì ìœ¼ë¡œ ìƒì„± -->
        </div>
        
        <div class="action-buttons">
            <button class="action-btn" id="submitBtn">í™•ì¸</button>
            <button class="action-btn reset" id="resetBtn">ì´ˆê¸°í™”</button>
            <button class="action-btn" id="newGameBtn">ìƒˆ ê²Œì„</button>
        </div>
        
        <div class="result-history" id="resultHistory"></div>
        
        <div id="winMessage" class="win-message" style="display: none;"></div>
    </div>

    <!-- ì˜¤ë””ì˜¤ ìš”ì†Œë“¤ -->
    <audio id="bgMusic" loop>
        <source src="Vintage-analog-arranger-keyboard-music-loop.wav" type="audio/mpeg">
    </audio>
    <audio id="numberSound">
        <source src="https://raw.githubusercontent.com/githubkorean/html/refs/heads/main/ìˆ«ì ìë¦¬ ë§ì¶”ê¸° ê²Œì„/Typewriter-key-press-sound.mp3" type="audio/mpeg">
    </audio>
    <audio id="submitSound">
        <source src="https://raw.githubusercontent.com/githubkorean/html/refs/heads/main/ìˆ«ì ìë¦¬ ë§ì¶”ê¸° ê²Œì„/Alert-message-tone.mp3" type="audio/mpeg">
    </audio>
    <audio id="resetSound">
        <source src="https://raw.githubusercontent.com/githubkorean/html/refs/heads/main/ìˆ«ì ìë¦¬ ë§ì¶”ê¸° ê²Œì„/Simple-message-tone.mp3" type="audio/mpeg">
    </audio>
    <audio id="newGameSound">
        <source src="https://raw.githubusercontent.com/githubkorean/html/refs/heads/main/ìˆ«ì ìë¦¬ ë§ì¶”ê¸° ê²Œì„/Message-sent-sound-effect.mp3" type="audio/mpeg">
    </audio>
    <audio id="winSound">
        <source src="https://raw.githubusercontent.com/githubkorean/html/refs/heads/main/ìˆ«ì ìë¦¬ ë§ì¶”ê¸° ê²Œì„/Holiday-message-tone.mp3" type="audio/mpeg">
    </audio>

    <script>
        // ê²Œì„ ìƒíƒœ ë³€ìˆ˜
        let answer = '';
        let currentGuess = '';
        let score = 0;
        let gameOver = false;
        let history = [];
        
        // DOM ìš”ì†Œ
        const currentGuessElement = document.getElementById('currentGuess');
        const numberButtons = document.getElementById('numberButtons');
        const submitBtn = document.getElementById('submitBtn');
        const resetBtn = document.getElementById('resetBtn');
        const newGameBtn = document.getElementById('newGameBtn');
        const resultHistory = document.getElementById('resultHistory');
        const winMessage = document.getElementById('winMessage');
        const scoreElement = document.getElementById('score');
        const startOverlay = document.getElementById('startOverlay');
        
        // ì˜¤ë””ì˜¤ ìš”ì†Œ
        const bgMusic = document.getElementById('bgMusic');
        const numberSound = document.getElementById('numberSound');
        const submitSound = document.getElementById('submitSound');
        const resetSound = document.getElementById('resetSound');
        const newGameSound = document.getElementById('newGameSound');
        const winSound = document.getElementById('winSound');
        const musicToggle = document.getElementById('musicToggle');
        
        // í˜ì´ì§€ ë¡œë“œ ì‹œ ê²Œì„ ì´ˆê¸°í™”
        document.addEventListener('DOMContentLoaded', function() {
            // ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ì—ì„œ ê²Œì„ ìƒíƒœ ë¶ˆëŸ¬ì˜¤ê¸°
            loadGameState();
            
            // ìˆ«ì ë²„íŠ¼ ìƒì„±
            createNumberButtons();
            
            // ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì„¤ì •
            submitBtn.addEventListener('click', submitGuess);
            resetBtn.addEventListener('click', resetCurrentGuess);
            newGameBtn.addEventListener('click', startNewGame);
            
            // ìŒì•… í† ê¸€ ì´ë²¤íŠ¸
            musicToggle.addEventListener('click', toggleMusic);
            
            // ì‹œì‘ ì˜¤ë²„ë ˆì´ í´ë¦­ ì´ë²¤íŠ¸
            startOverlay.addEventListener('click', function() {
                startOverlay.style.display = 'none';
                bgMusic.volume = 0.5;
                bgMusic.play().catch(e => console.log("Audio play failed:", e));
            });
            
            // ì •ë‹µì´ ì—†ìœ¼ë©´ ìƒˆ ê²Œì„ ì‹œì‘
            if (!answer || answer.length !== 4) {
                startOverlay.style.display = 'flex';
            } else {
                updateUI();
                // ê²Œì„ì´ ì´ë¯¸ ëë‚œ ìƒíƒœì¸ì§€ í™•ì¸
                if (isGameFinished()) {
                    handleFinishedGame();
                }
            }
        });
        
        // ê²Œì„ì´ ì´ë¯¸ ëë‚œ ìƒíƒœì¸ì§€ í™•ì¸
        function isGameFinished() {
            return history.length > 0 && history[history.length - 1].strikes === 4;
        }
        
        // ê²Œì„ì´ ëë‚œ ìƒíƒœ ì²˜ë¦¬
        function handleFinishedGame() {
            gameOver = true;
            const lastGuess = history[history.length - 1].guess;
            winMessage.textContent = `ğŸ‰ ì •ë‹µì„ ë§ì·„ìŠµë‹ˆë‹¤! (${lastGuess})`;
            winMessage.style.display = 'block';
            disableAllNumberButtons();
            submitBtn.disabled = true;
        }
        
        // ìŒì•… í† ê¸€
        function toggleMusic() {
            musicToggle.classList.toggle('active');
            if (musicToggle.classList.contains('active')) {
                bgMusic.play();
            } else {
                bgMusic.pause();
            }
        }
        
        // íš¨ê³¼ìŒ ì¬ìƒ
        function playSound(sound) {
            sound.currentTime = 0;
            sound.play().catch(e => console.log("Sound play failed:", e));
        }
        
        // ëª¨ë“  ìˆ«ì ë²„íŠ¼ í™œì„±í™”
        function enableAllNumberButtons() {
            document.querySelectorAll('.number-btn').forEach(btn => {
                btn.disabled = false;
            });
        }
        
        // ëª¨ë“  ìˆ«ì ë²„íŠ¼ ë¹„í™œì„±í™”
        function disableAllNumberButtons() {
            document.querySelectorAll('.number-btn').forEach(btn => {
                btn.disabled = true;
            });
        }
        
        // ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ì—ì„œ ê²Œì„ ìƒíƒœ ë¶ˆëŸ¬ì˜¤ê¸°
        function loadGameState() {
            const savedAnswer = localStorage.getItem('baseballAnswer');
            const savedScore = localStorage.getItem('baseballScore');
            const savedHistory = localStorage.getItem('baseballHistory');
            
            if (savedAnswer) answer = savedAnswer;
            if (savedScore) score = parseInt(savedScore);
            if (savedHistory) history = JSON.parse(savedHistory);
            
            scoreElement.textContent = score;
        }
        
        // ê²Œì„ ìƒíƒœ ì €ì¥
        function saveGameState() {
            localStorage.setItem('baseballAnswer', answer);
            localStorage.setItem('baseballScore', score);
            localStorage.setItem('baseballHistory', JSON.stringify(history));
        }
        
        // ìˆ«ì ë²„íŠ¼ ìƒì„±
        function createNumberButtons() {
            numberButtons.innerHTML = ''; // ê¸°ì¡´ ë²„íŠ¼ ì´ˆê¸°í™”
            for (let i = 0; i <= 9; i++) {
                const btn = document.createElement('button');
                btn.className = 'number-btn';
                btn.textContent = i;
                btn.dataset.number = i;
                btn.addEventListener('click', function() {
                    addNumberToGuess(i);
                });
                numberButtons.appendChild(btn);
            }
        }
        
        // ìƒˆ ê²Œì„ ì‹œì‘
        function startNewGame() {
            playSound(newGameSound);
            
            // ì •ë‹µ ìƒì„± (ì¤‘ë³µ ì—†ëŠ” 4ìë¦¬ ìˆ«ì)
            answer = '';
            while (answer.length < 4) {
                const digit = Math.floor(Math.random() * 10).toString();
                if (!answer.includes(digit)) {
                    answer += digit;
                }
            }
            
            // ê²Œì„ ìƒíƒœ ì´ˆê¸°í™”
            currentGuess = '';
            gameOver = false;
            history = [];
            
            // ëª¨ë“  ìˆ«ì ë²„íŠ¼ í™œì„±í™”
            enableAllNumberButtons();
            
            // UI ì—…ë°ì´íŠ¸
            updateUI();
            
            // ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ì— ì €ì¥
            saveGameState();
            
            // ìŠ¹ë¦¬ ë©”ì‹œì§€ ìˆ¨ê¸°ê¸°
            winMessage.style.display = 'none';
            submitBtn.disabled = false;
        }
        
        // ìˆ«ì ë²„íŠ¼ í´ë¦­ ì‹œ í˜„ì¬ ì¶”ì¸¡ì— ì¶”ê°€
        function addNumberToGuess(number) {
            if (gameOver || currentGuess.length >= 4) return;
            
            playSound(numberSound);
            currentGuess += number;
            updateUI();
            
            // ì‚¬ìš©í•œ ìˆ«ì ë²„íŠ¼ ë¹„í™œì„±í™”
            document.querySelector(`.number-btn[data-number="${number}"]`).disabled = true;
        }
        
        // í˜„ì¬ ì¶”ì¸¡ ì´ˆê¸°í™”
        function resetCurrentGuess() {
            if (gameOver) return;
            
            playSound(resetSound);
            currentGuess = '';
            updateUI();
            
            // ëª¨ë“  ìˆ«ì ë²„íŠ¼ í™œì„±í™”
            enableAllNumberButtons();
        }
        
        // ì¶”ì¸¡ ì œì¶œ
        function submitGuess() {
            if (gameOver || currentGuess.length !== 4) return;
            
            playSound(submitSound);
            
            // ì •ë‹µ í™•ì¸
            const result = checkAnswer(currentGuess);
            history.push({
                guess: currentGuess,
                strikes: result.strikes,
                balls: result.balls,
                outs: result.outs
            });
            
            // ì •ë‹µì„ ë§ì¶˜ ê²½ìš°
            if (result.strikes === 4) {
                handleCorrectAnswer();
            } else {
                currentGuess = '';
                updateUI();
                enableAllNumberButtons();
                saveGameState();
            }
        }
        
        // ì •ë‹µì„ ë§ì¶˜ ê²½ìš° ì²˜ë¦¬
        function handleCorrectAnswer() {
            gameOver = true;
            score++;
            scoreElement.textContent = score;
            
            // ìŠ¹ë¦¬ íš¨ê³¼ìŒ ì¬ìƒ
            playSound(winSound);
            
            // ìŠ¹ë¦¬ ë©”ì‹œì§€ í‘œì‹œ
            winMessage.textContent = `ğŸ‰ ì •ë‹µì„ ë§ì·„ìŠµë‹ˆë‹¤! (${currentGuess})`;
            winMessage.style.display = 'block';
            
            // ëª¨ë“  ìˆ«ì ë²„íŠ¼ ë¹„í™œì„±í™”
            disableAllNumberButtons();
            submitBtn.disabled = true;
            
            // ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ ì—…ë°ì´íŠ¸
            localStorage.removeItem('baseballAnswer');
            localStorage.setItem('baseballHistory', JSON.stringify(history));
            localStorage.setItem('baseballScore', score);
        }
        
        // ì •ë‹µ í™•ì¸
        function checkAnswer(guess) {
            let strikes = 0;
            let balls = 0;
            
            for (let i = 0; i < 4; i++) {
                if (guess[i] === answer[i]) {
                    strikes++;
                } else if (answer.includes(guess[i])) {
                    balls++;
                }
            }
            
            const outs = 4 - strikes - balls;
            
            return { strikes, balls, outs };
        }
        
        // UI ì—…ë°ì´íŠ¸
        function updateUI() {
            // í˜„ì¬ ì¶”ì¸¡ í‘œì‹œ
            currentGuessElement.textContent = currentGuess.padEnd(4, '_').split('').join(' ');
            
            // ê²°ê³¼ ê¸°ë¡ ì—…ë°ì´íŠ¸
            resultHistory.innerHTML = '';
            history.forEach((item, index) => {
                const resultItem = document.createElement('div');
                resultItem.className = 'result-item';
                
                const guessText = document.createElement('span');
                guessText.textContent = `${index + 1}. ${item.guess} - `;
                resultItem.appendChild(guessText);
                
                if (item.strikes === 4) {
                    const correctText = document.createElement('span');
                    correctText.textContent = 'ì •ë‹µ!';
                    correctText.style.color = '#2ecc71';
                    correctText.style.fontWeight = 'bold';
                    resultItem.appendChild(correctText);
                } else {
                    const strikeText = document.createElement('span');
                    strikeText.className = 'strike';
                    strikeText.textContent = `${item.strikes} ë™ì¼ í¬ì§€ì…˜ `;
                    resultItem.appendChild(strikeText);
                    
                    const ballText = document.createElement('span');
                    ballText.className = 'ball';
                    ballText.textContent = `${item.balls} ë‹¤ë¥¸ ìœ„ì¹˜ `;
                    resultItem.appendChild(ballText);
                    
                    const outText = document.createElement('span');
                    outText.className = 'out';
                    outText.textContent = `${item.outs} ë‚˜ë¨¸ì§€`;
                    resultItem.appendChild(outText);
                }
                
                resultHistory.appendChild(resultItem);
            });
            
            // ê²°ê³¼ ê¸°ë¡ì´ ìˆìœ¼ë©´ ìŠ¤í¬ë¡¤ì„ ë§¨ ì•„ë˜ë¡œ
            if (history.length > 0) {
                resultHistory.scrollTop = resultHistory.scrollHeight;
            }
            
            // í™•ì¸ ë²„íŠ¼ ìƒíƒœ ì—…ë°ì´íŠ¸
            submitBtn.disabled = currentGuess.length !== 4 || gameOver;
        }
    </script>
</body>
</html>
